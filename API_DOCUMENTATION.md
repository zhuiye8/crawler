# åŒ»ç–—æ–°é—»MVP APIæ–‡æ¡£

## åŸºæœ¬ä¿¡æ¯

- **åŸºç¡€URL**: `http://localhost:8000`
- **å‰ç«¯URL**: `http://localhost:5173`
- **APIç‰ˆæœ¬**: v1
- **è®¿é—®æ–¹å¼**: âœ… å®Œå…¨å¼€æ”¾ï¼Œæ— éœ€ä»»ä½•è®¤è¯

> **é‡è¦æç¤º**: æœ¬APIå®Œå…¨å¼€æ”¾ï¼Œä¸éœ€è¦ä»»ä½•è®¤è¯å³å¯è®¿é—®æ‰€æœ‰ç«¯ç‚¹ã€‚å¤–éƒ¨ç”¨æˆ·å¯ç›´æ¥è°ƒç”¨è·å–æ•°æ®ã€‚

---

## ç›®å½•

1. [å…¬å¼€æ–‡ç« API](#å…¬å¼€æ–‡ç« api)
2. [èŠå¤©API](#èŠå¤©api)
3. [ç®¡ç†ç«¯-æ–‡ç« ](#ç®¡ç†ç«¯-æ–‡ç« )
4. [ç®¡ç†ç«¯-çˆ¬è™«](#ç®¡ç†ç«¯-çˆ¬è™«)
5. [ç®¡ç†ç«¯-åˆ†æ](#ç®¡ç†ç«¯-åˆ†æ)
6. [é€šç”¨å“åº”æ ¼å¼](#é€šç”¨å“åº”æ ¼å¼)
7. [é”™è¯¯ç è¯´æ˜](#é”™è¯¯ç è¯´æ˜)

---

## å…¬å¼€æ–‡ç« API

### è·å–æ–‡ç« åˆ—è¡¨

è·å–å·²å‘å¸ƒçš„æ–‡ç« åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œè¿‡æ»¤ã€‚

**ç«¯ç‚¹**: `GET /v1/articles`

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|------|-----|
| page | integer | å¦ | é¡µç ï¼Œé»˜è®¤1 |
| page_size | integer | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100 |
| category | string | å¦ | æŒ‰åˆ†ç±»è¿‡æ»¤ |
| from_date | string | å¦ | èµ·å§‹æ—¥æœŸ (YYYY-MM-DD) |

**å“åº”** (200 OK):
```json
{
  "data": [
    {
      "id": 1,
      "title": "å®Œèƒœå¸ç¾æ ¼é²è‚½",
      "summary": "æ–‡ç« æ‘˜è¦å†…å®¹...",
      "author": "è¯æ¸¡äº‘",
      "source_name": "è¯æ¸¡äº‘",
      "category": "å‰æ²¿ç ”ç©¶",
      "tags": ["å‡è‚¥è¯", "GLP-1"],
      "published_at": "2025-11-03T10:00:00"
    }
  ],
  "pagination": {
    "total": 150,
    "page": 1,
    "page_size": 20
  }
}
```

**ç¤ºä¾‹**:
```bash
# è·å–ç¬¬1é¡µï¼Œæ¯é¡µ20æ¡
curl http://localhost:8000/v1/articles?page=1&page_size=20

# æŒ‰åˆ†ç±»è¿‡æ»¤
curl http://localhost:8000/v1/articles?category=å‰æ²¿ç ”ç©¶

# æŒ‰æ—¥æœŸè¿‡æ»¤
curl "http://localhost:8000/v1/articles?from_date=2025-10-01"
```

### è·å–æ–‡ç« è¯¦æƒ…

è·å–å•ç¯‡æ–‡ç« çš„å®Œæ•´å†…å®¹å’ŒAIåˆ†æç»“æœã€‚

**ç«¯ç‚¹**: `GET /v1/articles/{article_id}`

**è·¯å¾„å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----|------|-----|
| article_id | integer | æ–‡ç« ID |

**å“åº”** (200 OK):
```json
{
  "id": 1,
  "title": "å®Œèƒœå¸ç¾æ ¼é²è‚½",
  "summary": "æ–‡ç« æ‘˜è¦...",
  "author": "è¯æ¸¡äº‘",
  "source_name": "è¯æ¸¡äº‘",
  "category": "å‰æ²¿ç ”ç©¶",
  "tags": ["å‡è‚¥è¯"],
  "published_at": "2025-11-03T10:00:00",
  "content_url": "https://www.pharnexcloud.com/...",
  "content_text": "å®Œæ•´çš„æ–‡ç« çº¯æ–‡æœ¬å†…å®¹...",
  "content_html": "<div>å®Œæ•´çš„HTMLå†…å®¹ï¼ˆåŒ…å«æ ¼å¼ï¼Œå›¾ç‰‡ï¼Œé“¾æ¥ç­‰ï¼‰...</div>",
  "content_source": "wechat",
  "ai_analysis": {
    "analysis": "ä¿¡è¾¾ç”Ÿç‰©è‡ªä¸»ç ”å‘çš„GCG/GLP-1åŒå—ä½“æ¿€åŠ¨å‰‚ç›ä»•åº¦è‚½åœ¨å…¶â…¢æœŸä¸´åºŠè¯•éªŒDREAMS-3ä¸­å±•ç°å‡ºæ˜¾è‘—ä¼˜äºå¸ç¾æ ¼é²è‚½çš„ç»¼åˆç–—æ•ˆã€‚è¯¥ç ”ç©¶é’ˆå¯¹ä¸­å›½2å‹ç³–å°¿ç—…åˆå¹¶è‚¥èƒ–æ‚£è€…ï¼Œç»“æœæ˜¾ç¤ºç›ä»•åº¦è‚½ç»„æœ‰49.7%çš„æ‚£è€…å®ç°è¡€ç³–è¾¾æ ‡ä¸”ä½“é‡ä¸‹é™â‰¥10%ï¼Œè¿œé«˜äºå¸ç¾æ ¼é²è‚½ç»„çš„21%ã€‚è¿™ä¸€çªç ´æ€§æˆæœä¸ä»…éªŒè¯äº†GCG/GLP-1åŒé¶ç‚¹æ¿€åŠ¨æœºåˆ¶çš„ä¸´åºŠä¼˜åŠ¿ï¼Œä¹Ÿä¸ºä¿¡è¾¾ç”Ÿç‰©åœ¨ä»£è°¢ç–¾ç—…æ²»ç–—é¢†åŸŸçš„å·®å¼‚åŒ–ç«äº‰å¥ å®šäº†åŸºç¡€ã€‚"
  }
}
```

**å†…å®¹å­—æ®µè¯´æ˜**:
- `content_text`: æ–‡ç« å®Œæ•´çº¯æ–‡æœ¬å†…å®¹
- `content_html`: æ–‡ç« å®Œæ•´HTMLæ ¼å¼å†…å®¹ï¼ˆé€šç”¨å­—æ®µï¼Œé€‚ç”¨äºæ‰€æœ‰æ•°æ®æºï¼‰
- `content_source`: å†…å®¹æ¥æºæ ‡è¯†ï¼ˆå¦‚"wechat"ã€"pharnexcloud"ç­‰ï¼‰

**é€šç”¨è®¾è®¡è¯´æ˜**:
- `content_html` æ˜¯é€šç”¨å­—æ®µï¼Œæ— è®ºå†…å®¹æ¥æºæ˜¯å¾®ä¿¡ã€è¯æ¸¡äº‘è¿˜æ˜¯å…¶ä»–æ•°æ®æºï¼Œéƒ½ä½¿ç”¨ç»Ÿä¸€å­—æ®µå
- ç³»ç»Ÿä¼šæ™ºèƒ½é€‰æ‹©æœ€ä½³çš„HTMLå†…å®¹ï¼šä¼˜å…ˆä½¿ç”¨å¾®ä¿¡HTMLï¼ˆæ ¼å¼æ›´ä¸°å¯Œï¼‰ï¼Œå¦åˆ™ä½¿ç”¨å…¶ä»–æ¥æºçš„HTML
- `content_text` æä¾›çº¯æ–‡æœ¬ç‰ˆæœ¬ï¼Œä¾¿äºæœç´¢å’Œå¤„ç†
- å‰ç«¯å¯æ ¹æ®éœ€è¦é€‰æ‹©ä½¿ç”¨HTMLæ ¼å¼ï¼ˆä¿ç•™æ ·å¼ï¼‰æˆ–çº¯æ–‡æœ¬æ ¼å¼

**ç¤ºä¾‹**:
```bash
curl http://localhost:8000/v1/articles/1
```

### ç”ŸæˆAIåˆ†æ

ä¸ºæŒ‡å®šæ–‡ç« ç”Ÿæˆæˆ–è·å–AIæ™ºèƒ½åˆ†æã€‚æ”¯æŒè‡ªåŠ¨ç¼“å­˜ï¼Œé¿å…é‡å¤åˆ†æã€‚

**ç«¯ç‚¹**: `POST /v1/articles/{article_id}/analyze`

**è·¯å¾„å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----|------|-----|
| article_id | integer | æ–‡ç« ID |

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|------|-------|-----|
| force_regenerate | boolean | å¦ | false | æ˜¯å¦å¼ºåˆ¶é‡æ–°ç”Ÿæˆåˆ†æ |

**å“åº”** (200 OK):
```json
{
  "success": true,
  "message": "AIåˆ†æå®Œæˆ",
  "data": {
    "analysis": "ä¿¡è¾¾ç”Ÿç‰©è‡ªä¸»ç ”å‘çš„GCG/GLP-1åŒå—ä½“æ¿€åŠ¨å‰‚ç›ä»•åº¦è‚½ï¼ˆmazdutideï¼‰åœ¨å…¶â…¢æœŸä¸´åºŠè¯•éªŒDREAMS-3ä¸­ï¼Œé’ˆå¯¹ä¸­å›½2å‹ç³–å°¿ç—…åˆå¹¶è‚¥èƒ–æ‚£è€…ï¼Œå±•ç°å‡ºåœ¨è¡€ç³–æ§åˆ¶ä¸ä½“é‡ç®¡ç†æ–¹é¢çš„ç»¼åˆç–—æ•ˆæ˜¾è‘—ä¼˜äºå›½é™…ä¸»æµè¯ç‰©å¸ç¾æ ¼é²è‚½ã€‚å…·ä½“æ•°æ®æ˜¾ç¤ºï¼Œç›ä»•åº¦è‚½ç»„æœ‰49.7%çš„æ‚£è€…å®ç°è¡€ç³–è¾¾æ ‡ä¸”ä½“é‡ä¸‹é™â‰¥10%ï¼Œè¿œé«˜äºå¸ç¾æ ¼é²è‚½ç»„çš„21%..."
  }
}
```

**ç‰¹æ€§è¯´æ˜**:
- ğŸ§  **æ™ºèƒ½ç¼“å­˜**: å·²æœ‰åˆ†ææ—¶ç›´æ¥è¿”å›ï¼Œé¿å…é‡å¤è°ƒç”¨AI API
- ğŸ”„ **å¼ºåˆ¶é‡æ–°ç”Ÿæˆ**: è®¾ç½® `force_regenerate=true` å¯é‡æ–°åˆ†æ
- ğŸ“ **ä¸“ä¸šåˆ†æ**: 150-250å­—çš„åŒ»è¯è¡Œä¸šä¸“ä¸šåˆ†æ
- ğŸ‡¨ğŸ‡³ **ä¸­æ–‡è¾“å‡º**: ç®€ä½“ä¸­æ–‡ï¼Œä¸“ä¸šä½†æ˜“æ‡‚
- âš¡ **å¿«é€Ÿå“åº”**: ä½¿ç”¨DeepSeek APIï¼Œå“åº”é€Ÿåº¦å¿«

**ç¤ºä¾‹**:
```bash
# é¦–æ¬¡ç”ŸæˆAIåˆ†æ
curl -X POST http://localhost:8000/v1/articles/62/analyze

# è·å–å·²æœ‰åˆ†æï¼ˆç¼“å­˜ï¼‰
curl -X POST http://localhost:8000/v1/articles/62/analyze?force_regenerate=false

# å¼ºåˆ¶é‡æ–°ç”Ÿæˆ
curl -X POST http://localhost:8000/v1/articles/62/analyze?force_regenerate=true
```

**é”™è¯¯å“åº”**:
```json
# æ–‡ç« ä¸å­˜åœ¨
{
  "detail": "Article not found"
}

# AIåˆ†æå¤±è´¥
{
  "detail": "AIåˆ†æå¤±è´¥: DeepSeek API key not configured"
}
```

---

## èŠå¤©API

### RAGé—®ç­”

åŸºäºæ–‡ç« çŸ¥è¯†åº“è¿›è¡Œæ™ºèƒ½é—®ç­”ã€‚**å®Œå…¨å¼€æ”¾ï¼Œæ— éœ€è®¤è¯ã€‚**

**ç«¯ç‚¹**: `POST /v1/chat`

**è¯·æ±‚å¤´**:
```
Content-Type: application/json
```

**è¯·æ±‚ä½“**:
```json
{
  "question": "GLP-1å‡è‚¥è¯çš„æœ€æ–°ç ”ç©¶è¿›å±•æ˜¯ä»€ä¹ˆï¼Ÿ",
  "conversation_id": "uuid-string"  // å¯é€‰ï¼Œç”¨äºå¤šè½®å¯¹è¯
}
```

**å“åº”** (200 OK):
```json
{
  "answer": "æ ¹æ®æœ€æ–°ç ”ç©¶ï¼ŒGLP-1å‡è‚¥è¯...",
  "sources": [
    {
      "article_id": 1,
      "title": "å®Œèƒœå¸ç¾æ ¼é²è‚½",
      "excerpt": "ç›¸å…³å†…å®¹ç‰‡æ®µ..."
    }
  ],
  "conversation_id": "uuid-string"
}
```

**ç¤ºä¾‹**:
```bash
# ç›´æ¥è°ƒç”¨ï¼Œæ— éœ€token
curl -X POST http://localhost:8000/v1/chat \
  -H "Content-Type: application/json" \
  -d '{"question": "GLP-1å‡è‚¥è¯æœ‰å“ªäº›ï¼Ÿ"}'

# å¤šè½®å¯¹è¯ç¤ºä¾‹
curl -X POST http://localhost:8000/v1/chat \
  -H "Content-Type: application/json" \
  -d '{
    "question": "è¿˜æœ‰å“ªäº›å‰¯ä½œç”¨ï¼Ÿ",
    "conversation_id": "ä¹‹å‰è¿”å›çš„conversation_id"
  }'
```

---

## ç®¡ç†ç«¯-æ–‡ç« 

ç®¡ç†ç«¯æ–‡ç« æ¥å£æä¾›æ›´å¼ºå¤§çš„æœç´¢ã€ç¼–è¾‘å’Œç®¡ç†åŠŸèƒ½ã€‚

### è·å–æ–‡ç« åˆ—è¡¨ï¼ˆç®¡ç†ç«¯ï¼‰

**ç«¯ç‚¹**: `GET /v1/admin/articles/`

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-----|------|------|-----|
| page | integer | å¦ | é¡µç ï¼Œé»˜è®¤1 |
| page_size | integer | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20 |
| keyword | string | å¦ | å…³é”®è¯æœç´¢ï¼ˆæ ‡é¢˜/æ‘˜è¦/ä½œè€…ï¼‰ |
| category | string | å¦ | åˆ†ç±»è¿‡æ»¤ |
| content_source | string | å¦ | æ¥æºè¿‡æ»¤ (wechat/pharnexcloud) |
| from_date | string | å¦ | èµ·å§‹æ—¥æœŸ (YYYY-MM-DD) |
| to_date | string | å¦ | ç»“æŸæ—¥æœŸ (YYYY-MM-DD) |

**å“åº”** (200 OK):
```json
{
  "total": 150,
  "page": 1,
  "page_size": 20,
  "total_pages": 8,
  "items": [
    {
      "id": 1,
      "title": "å®Œèƒœå¸ç¾æ ¼é²è‚½",
      "summary": "æ‘˜è¦...",
      "author": "è¯æ¸¡äº‘",
      "category": "å‰æ²¿ç ”ç©¶",
      "tags": ["å‡è‚¥è¯"],
      "published_at": "2025-11-03T10:00:00",
      "content_source": "wechat",
      "created_at": "2025-11-03T09:00:00"
    }
  ]
}
```

**ç¤ºä¾‹**:
```bash
# å…³é”®è¯æœç´¢
curl "http://localhost:8000/v1/admin/articles/?keyword=å‡è‚¥è¯"

# æŒ‰æ¥æºè¿‡æ»¤
curl "http://localhost:8000/v1/admin/articles/?content_source=wechat"

# ç»„åˆæœç´¢
curl "http://localhost:8000/v1/admin/articles/?keyword=GLP-1&from_date=2025-10-01&to_date=2025-11-03"
```

### è·å–æ–‡ç« è¯¦æƒ…ï¼ˆç®¡ç†ç«¯ï¼‰

**ç«¯ç‚¹**: `GET /v1/admin/articles/{article_id}`

**å“åº”** (200 OK):
```json
{
  "id": 1,
  "title": "å®Œèƒœå¸ç¾æ ¼é²è‚½",
  "summary": "æ‘˜è¦...",
  "author": "è¯æ¸¡äº‘",
  "category": "å‰æ²¿ç ”ç©¶",
  "tags": ["å‡è‚¥è¯"],
  "published_at": "2025-11-03T10:00:00",
  "content_url": "https://...",
  "content_text": "å®Œæ•´æ–‡æœ¬å†…å®¹...",
  "content_html": "<div>å®Œæ•´HTMLå†…å®¹...</div>",
  "content_source": "wechat",
  "original_source_url": "https://mp.weixin.qq.com/...",
  "translated_content_html": "<div>ç¿»è¯‘åçš„HTMLå†…å®¹ï¼ˆå¦‚æœ‰ï¼‰</div>",
  "created_at": "2025-11-03T09:00:00",
  "updated_at": "2025-11-03T09:30:00"
}
```

### æ›´æ–°æ–‡ç« 

**ç«¯ç‚¹**: `PUT /v1/admin/articles/{article_id}`

**è¯·æ±‚ä½“**:
```json
{
  "title": "æ–°æ ‡é¢˜",
  "summary": "æ–°æ‘˜è¦",
  "category": "ä¸´åºŠè¯•éªŒ",
  "tags": ["æ–°æ ‡ç­¾"]
}
```

**å“åº”** (200 OK): è¿”å›æ›´æ–°åçš„æ–‡ç« å¯¹è±¡

### åˆ é™¤æ–‡ç« ï¼ˆè½¯åˆ é™¤ï¼‰

**ç«¯ç‚¹**: `DELETE /v1/admin/articles/{article_id}`

**å“åº”** (200 OK):
```json
{
  "message": "Deleted successfully",
  "article_id": 1
}
```

### æ‰¹é‡åˆ é™¤æ–‡ç« 

**ç«¯ç‚¹**: `DELETE /v1/admin/articles/batch/delete`

**è¯·æ±‚ä½“**:
```json
{
  "article_ids": [1, 2, 3, 4, 5]
}
```

**å“åº”** (200 OK):
```json
{
  "message": "Batch delete successful",
  "deleted_count": 5,
  "total_requested": 5
}
```

**ç¤ºä¾‹**:
```bash
curl -X DELETE http://localhost:8000/v1/admin/articles/batch/delete \
  -H "Content-Type: application/json" \
  -d '{"article_ids": [1,2,3]}'
```

---

## ç®¡ç†ç«¯-çˆ¬è™«

çˆ¬è™«ç®¡ç†æ¥å£ç”¨äºå¯åŠ¨çˆ¬å–ä»»åŠ¡ã€æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€å’Œæ—¥å¿—ã€‚

### è·å–å¯ç”¨æ•°æ®æº

**ç«¯ç‚¹**: `GET /v1/admin/crawler/sources`

**å“åº”** (200 OK):
```json
[
  {
    "name": "pharnexcloud",
    "display_name": "è¯æ¸¡äº‘",
    "description": "è¯æ¸¡äº‘å‰æ²¿ç ”ç©¶æ ç›®",
    "supports_wechat": true
  }
]
```

### åˆ›å»ºçˆ¬è™«ä»»åŠ¡

**ç«¯ç‚¹**: `POST /v1/admin/crawler/tasks`

**è¯·æ±‚ä½“**:
```json
{
  "source": "pharnexcloud",
  "pages": 10,
  "max_articles": 50,
  "days_back": 7,
  "from_date": "2025-10-01",
  "to_date": "2025-11-03"
}
```

**å‚æ•°è¯´æ˜**:
- `source`: æ•°æ®æºåç§° (ç›®å‰æ”¯æŒ: pharnexcloud)
- `pages`: çˆ¬å–é¡µæ•°ï¼Œé»˜è®¤10
- `max_articles`: æœ€å¤§æ–‡ç« æ•°ï¼Œå¯é€‰
- `days_back`: çˆ¬å–æœ€è¿‘Nå¤©çš„æ–‡ç« ï¼Œå¯é€‰
- `from_date`: èµ·å§‹æ—¥æœŸï¼Œå¯é€‰
- `to_date`: ç»“æŸæ—¥æœŸï¼Œå¯é€‰

**å“åº”** (200 OK):
```json
{
  "message": "Task created and started",
  "task_id": 23,
  "config": {
    "pages": 10,
    "max_articles": 50
  }
}
```

**ç¤ºä¾‹**:
```bash
# çˆ¬å–æœ€è¿‘7å¤©çš„æ–‡ç« 
curl -X POST http://localhost:8000/v1/admin/crawler/tasks \
  -H "Content-Type: application/json" \
  -d '{"source": "pharnexcloud", "pages": 10, "days_back": 7}'

# çˆ¬å–æŒ‡å®šæ—¥æœŸèŒƒå›´
curl -X POST http://localhost:8000/v1/admin/crawler/tasks \
  -H "Content-Type: application/json" \
  -d '{
    "source": "pharnexcloud",
    "pages": 5,
    "from_date": "2025-10-01",
    "to_date": "2025-11-01"
  }'
```

### è·å–çˆ¬è™«ä»»åŠ¡åˆ—è¡¨

**ç«¯ç‚¹**: `GET /v1/admin/crawler/tasks`

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----|------|-----|
| page | integer | é¡µç  |
| page_size | integer | æ¯é¡µæ•°é‡ |
| status | string | çŠ¶æ€è¿‡æ»¤ (pending/running/completed/failed) |

**å“åº”** (200 OK):
```json
{
  "total": 23,
  "page": 1,
  "page_size": 20,
  "items": [
    {
      "id": 23,
      "config": {
        "pages": 10,
        "max_articles": 50
      },
      "status": "completed",
      "articles_count": 45,
      "started_at": "2025-11-03T10:00:00",
      "completed_at": "2025-11-03T10:05:00",
      "error_message": null,
      "created_at": "2025-11-03T09:59:00"
    }
  ]
}
```

### è·å–ä»»åŠ¡è¯¦æƒ…

**ç«¯ç‚¹**: `GET /v1/admin/crawler/tasks/{task_id}`

**å“åº”** (200 OK): è¿”å›å•ä¸ªä»»åŠ¡å¯¹è±¡

### è·å–çˆ¬è™«çŠ¶æ€

**ç«¯ç‚¹**: `GET /v1/admin/crawler/status`

**å“åº”** (200 OK):
```json
{
  "is_running": true,
  "current_task": {
    "id": 23,
    "status": "running",
    "config": {"pages": 10}
  },
  "progress": {
    "current_page": 3,
    "total_pages": 10,
    "articles_found": 15
  }
}
```

### è·å–çˆ¬è™«æ—¥å¿—

**ç«¯ç‚¹**: `GET /v1/admin/crawler/logs`

**å“åº”** (200 OK):
```json
[
  {
    "timestamp": "2025-11-03T10:00:00",
    "level": "INFO",
    "message": "ä»»åŠ¡ #23 å¼€å§‹æ‰§è¡Œ..."
  },
  {
    "timestamp": "2025-11-03T10:00:10",
    "level": "INFO",
    "message": "æ­£åœ¨çˆ¬å–ç¬¬ 1 é¡µ..."
  }
]
```

**ç¤ºä¾‹**:
```bash
# å®æ—¶ç›‘æ§çˆ¬è™«æ—¥å¿—
while true; do
  curl -s http://localhost:8000/v1/admin/crawler/logs | jq '.'
  sleep 2
done
```

---

## ç®¡ç†ç«¯-åˆ†æ

æ•°æ®åˆ†æå’Œç»Ÿè®¡æ¥å£ã€‚

### è·å–æ¦‚è§ˆç»Ÿè®¡

**ç«¯ç‚¹**: `GET /v1/admin/analytics/overview`

**å“åº”** (200 OK):
```json
{
  "total_articles": 150,
  "today_articles": 5,
  "week_articles": 35,
  "month_articles": 120,
  "wechat_articles": 80,
  "pharnex_articles": 70
}
```

### è·å–æ–‡ç« è¶‹åŠ¿

**ç«¯ç‚¹**: `GET /v1/admin/analytics/trends`

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|-----|
| days | integer | 30 | åˆ†æå¤©æ•° (1-365) |

**å“åº”** (200 OK):
```json
[
  {
    "date": "2025-10-01",
    "count": 5
  },
  {
    "date": "2025-10-02",
    "count": 8
  }
]
```

**ç¤ºä¾‹**:
```bash
# è·å–æœ€è¿‘30å¤©è¶‹åŠ¿
curl http://localhost:8000/v1/admin/analytics/trends?days=30

# è·å–æœ€è¿‘7å¤©è¶‹åŠ¿
curl http://localhost:8000/v1/admin/analytics/trends?days=7
```

### è·å–æ¥æºåˆ†å¸ƒ

**ç«¯ç‚¹**: `GET /v1/admin/analytics/sources`

**å“åº”** (200 OK):
```json
[
  {
    "source": "WeChat",
    "count": 80,
    "percentage": 53.33
  },
  {
    "source": "PharnexCloud",
    "count": 70,
    "percentage": 46.67
  }
]
```

### è·å–åˆ†ç±»åˆ†å¸ƒ

**ç«¯ç‚¹**: `GET /v1/admin/analytics/categories`

**å“åº”** (200 OK):
```json
[
  {
    "category": "å‰æ²¿ç ”ç©¶",
    "count": 85
  },
  {
    "category": "ä¸´åºŠè¯•éªŒ",
    "count": 45
  },
  {
    "category": "è¯ç‰©å®¡æ‰¹",
    "count": 20
  }
]
```

---

## é€šç”¨å“åº”æ ¼å¼

### æˆåŠŸå“åº”

æ‰€æœ‰æˆåŠŸçš„APIè¯·æ±‚è¿”å›HTTPçŠ¶æ€ç  `2xx` å’ŒJSONæ ¼å¼æ•°æ®ã€‚

### åˆ†é¡µå“åº”

åŒ…å«åˆ†é¡µçš„å“åº”æ ¼å¼ï¼š
```json
{
  "total": 150,
  "page": 1,
  "page_size": 20,
  "total_pages": 8,
  "items": [...]
}
```

---

## é”™è¯¯ç è¯´æ˜

### HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|-----|
| 200 | æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒï¼ˆéœ€è¦ç™»å½•ï¼‰ |
| 403 | ç¦æ­¢è®¿é—® |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

### é”™è¯¯å“åº”æ ¼å¼

```json
{
  "detail": "é”™è¯¯è¯¦ç»†ä¿¡æ¯"
}
```

### å¸¸è§é”™è¯¯ç¤ºä¾‹

**400 Bad Request**:
```json
{
  "detail": "Invalid date format. Use YYYY-MM-DD"
}
```

**404 Not Found**:
```json
{
  "detail": "Article not found"
}
```

**500 Internal Server Error**:
```json
{
  "detail": "Chat error: DeepSeek API key not configured"
}
```

---

## è‡ªåŠ¨APIæ–‡æ¡£

FastAPIè‡ªåŠ¨ç”Ÿæˆçš„äº¤äº’å¼APIæ–‡æ¡£ï¼š

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

è¿™äº›ç•Œé¢æä¾›ï¼š
- æ‰€æœ‰APIç«¯ç‚¹çš„è¯¦ç»†è¯´æ˜
- è¯·æ±‚/å“åº”ç¤ºä¾‹
- åœ¨çº¿æµ‹è¯•åŠŸèƒ½
- æ•°æ®æ¨¡å‹Schema

---

## æ³¨æ„äº‹é¡¹

1. **å®Œå…¨å¼€æ”¾**: âœ… æ‰€æœ‰APIå®Œå…¨å¼€æ”¾ï¼Œæ— éœ€ä»»ä½•è®¤è¯å³å¯è®¿é—®
2. **æ—¶åŒº**: æ‰€æœ‰æ—¶é—´å­—æ®µä½¿ç”¨ä¸­å›½æ—¶åŒºï¼ˆAsia/Shanghai, UTC+8ï¼‰
3. **è½¯åˆ é™¤**: åˆ é™¤æ“ä½œä¸ºè½¯åˆ é™¤ï¼Œæ–‡ç« ä»ä¿ç•™åœ¨æ•°æ®åº“ä¸­ï¼ˆ`is_deleted=true`ï¼‰
4. **ç‰©ç†åˆ é™¤**: å·²åˆ é™¤çš„æ–‡ç« ä¼šåœ¨30å¤©åè‡ªåŠ¨ç‰©ç†åˆ é™¤ï¼ˆæ¯å¤©å‡Œæ™¨3:00æ‰§è¡Œï¼‰
5. **çˆ¬è™«é™åˆ¶**: åŒä¸€æ—¶é—´åªèƒ½è¿è¡Œä¸€ä¸ªçˆ¬è™«ä»»åŠ¡
6. **å¾®ä¿¡å†…å®¹**: ç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•çˆ¬å–å¾®ä¿¡å…¬ä¼—å·åŸæ–‡ï¼ˆå¦‚æœæœ‰é“¾æ¥ï¼‰

### å®‰å…¨å»ºè®®

è™½ç„¶APIå®Œå…¨å¼€æ”¾ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®ï¼š
- ä½¿ç”¨åå‘ä»£ç†ï¼ˆNginxï¼‰æ·»åŠ åŸºç¡€çš„IPç™½åå•
- ç›‘æ§DeepSeek APIä½¿ç”¨é‡ï¼Œé¿å…è¶…é¢è´¹ç”¨
- å®šæœŸæ£€æŸ¥æ•°æ®åº“è®¿é—®æ—¥å¿—
- è€ƒè™‘æ·»åŠ ç®€å•çš„API keyæˆ–rate limitingï¼ˆå¦‚æœ‰éœ€è¦ï¼‰

---

## é‡è¦å­—æ®µå˜æ›´è¯´æ˜ âš ï¸

ä¸ºäº†ç»Ÿä¸€æ•°æ®ç»“æ„å’Œæå‡å¯ç»´æŠ¤æ€§ï¼Œä»¥ä¸‹å­—æ®µå·²åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ç§»é™¤ï¼š

### å·²åˆ é™¤çš„å­—æ®µï¼ˆè¯·å‹¿ä½¿ç”¨ï¼‰
- âŒ `wechat_content_html` - å·²åˆ é™¤ï¼Œè¯·ä½¿ç”¨ `content_html`
- âŒ `wechat_content_text` - å·²åˆ é™¤ï¼Œè¯·ä½¿ç”¨ `content_text`
- âŒ `translated_content_text` - å·²åˆ é™¤ï¼Œä»…ä¿ç•™HTMLç¿»è¯‘

### å½“å‰ä½¿ç”¨çš„å­—æ®µ
- âœ… `content_html` - **é€šç”¨HTMLå†…å®¹å­—æ®µ**ï¼ˆé€‚ç”¨äºæ‰€æœ‰æ•°æ®æºï¼‰
- âœ… `content_text` - çº¯æ–‡æœ¬å†…å®¹
- âœ… `content_source` - å†…å®¹æ¥æºæ ‡è¯†ï¼ˆ`pharnexcloud` / `wechat`ï¼‰
- âœ… `translated_content_html` - AIç¿»è¯‘åçš„HTMLå†…å®¹
- âœ… `original_source_url` - å¾®ä¿¡åŸæ–‡é“¾æ¥ï¼ˆå¦‚æœæ¥æºæ˜¯å¾®ä¿¡ï¼‰

### è¿ç§»æŒ‡å—

**æ—§ä»£ç **:
```javascript
// âŒ ä¸å†æ”¯æŒ
const wechatHtml = article.wechat_content_html;
```

**æ–°ä»£ç **:
```javascript
// âœ… æ¨èä½¿ç”¨
const html = article.content_html;
const source = article.content_source; // "pharnexcloud" æˆ– "wechat"
const translation = article.translated_content_html; // ç¿»è¯‘å†…å®¹ï¼ˆå¦‚æœ‰ï¼‰
```

---

## ç¿»è¯‘åŠŸèƒ½è¯´æ˜

### AIç¿»è¯‘æ¥å£

æ–‡ç« ç¿»è¯‘APIä½äºå…¬å¼€APIéƒ¨åˆ†ï¼ˆè¯¦è§ä¸Šæ–‡"ç”Ÿæˆç¿»è¯‘"ç« èŠ‚ï¼‰ï¼Œä¸»è¦ç‰¹æ€§ï¼š

**æ™ºèƒ½è¯­è¨€æ£€æµ‹**:
- è‡ªåŠ¨æ£€æµ‹æ–‡ç« è¯­è¨€
- ä»…ç¿»è¯‘éä¸­æ–‡å†…å®¹
- ä¸­æ–‡æ–‡ç« ç›´æ¥è¿”å›åŸæ–‡

**HTMLæ ¼å¼ä¿ç•™**:
- å®Œæ•´ä¿ç•™HTMLæ ‡ç­¾å’Œç»“æ„
- ä¿æŒå›¾ç‰‡ã€é“¾æ¥ç­‰å…ƒç´ 
- ä¿ç•™CSSç±»åå’Œæ ·å¼

**ç¼“å­˜æœºåˆ¶**:
- ç¿»è¯‘ç»“æœå­˜å‚¨åœ¨ `translated_content_html` å­—æ®µ
- æ”¯æŒ `force_regenerate` å‚æ•°å¼ºåˆ¶é‡æ–°ç¿»è¯‘

**ä½¿ç”¨ç¤ºä¾‹**:
```bash
# ç¿»è¯‘è‹±æ–‡æ–‡ç« 
curl -X POST http://localhost:8000/v1/articles/1/translate

# å¼ºåˆ¶é‡æ–°ç¿»è¯‘
curl -X POST http://localhost:8000/v1/articles/1/translate?force_regenerate=true
```

---

## æ›´æ–°æ—¥å¿—

### v1.2.0 (2025-11-03)
- ğŸŒ **AIç¿»è¯‘åŠŸèƒ½**: æ–°å¢æ–‡ç« AIç¿»è¯‘æ¥å£ï¼Œè‡ªåŠ¨æ£€æµ‹å¹¶ç¿»è¯‘éä¸­æ–‡å†…å®¹
- ğŸ—„ï¸ **æ•°æ®ç»“æ„ä¼˜åŒ–**: ç»Ÿä¸€å†…å®¹å­—æ®µï¼Œç§»é™¤ç‰¹å®šæ¥æºå­—æ®µ
- ğŸ”§ **å­—æ®µé‡æ„**: åˆ é™¤ `wechat_content_*` å’Œ `translated_content_text` å­—æ®µ
- âœ¨ **é€šç”¨è®¾è®¡**: ä½¿ç”¨ `content_html` å’Œ `content_source` ç»Ÿä¸€å¤„ç†æ‰€æœ‰æ•°æ®æº
- ğŸ“ **HTMLä¿ç•™**: ç¿»è¯‘æ—¶å®Œæ•´ä¿ç•™HTMLæ ¼å¼å’Œæ ·å¼

### v1.1.0 (2025-11-03)
- ğŸ†• **AIæ™ºèƒ½åˆ†æ**: æ–°å¢æ–‡ç« AIåˆ†æåŠŸèƒ½ï¼Œæ”¯æŒä¸€é”®ç”Ÿæˆä¸“ä¸šåŒ»è¯åˆ†æ
- ğŸ”„ **DeepSeeké›†æˆ**: å®Œå…¨æ›¿æ¢OpenAIï¼Œä½¿ç”¨DeepSeek APIæä¾›æ›´å¿«æ›´ç»æµçš„AIæœåŠ¡
- ğŸ’¾ **æ™ºèƒ½ç¼“å­˜**: AIåˆ†æç»“æœè‡ªåŠ¨ç¼“å­˜ï¼Œé¿å…é‡å¤è°ƒç”¨APIèŠ‚çœæˆæœ¬
- ğŸ¯ **å¼ºåˆ¶é‡æ–°ç”Ÿæˆ**: æ”¯æŒforce_regenerateå‚æ•°å¼ºåˆ¶é‡æ–°åˆ†æ
- ğŸ‡¨ğŸ‡³ **ä¸“ä¸šä¸­æ–‡åˆ†æ**: 150-250å­—åŒ»è¯è¡Œä¸šä¸“ä¸šåˆ†æï¼Œç®€ä½“ä¸­æ–‡è¾“å‡º
- ğŸ¨ **åå°UIæ›´æ–°**: ç®¡ç†åå°æ–°å¢AIåˆ†ææ¨¡å—ï¼Œæ”¯æŒæŸ¥çœ‹å’Œé‡æ–°ç”Ÿæˆ
- ğŸ—ƒï¸ **æ•°æ®æ ¼å¼ç»Ÿä¸€**: æ¸…ç†æ—§æ ¼å¼æ•°æ®ï¼Œç»Ÿä¸€ä½¿ç”¨ç®€åŒ–åˆ†ææ ¼å¼

### v1.0.0 (2025-11-03)
- âœ… å®Œæ•´çš„æ–‡ç« ç®¡ç†API
- âœ… çˆ¬è™«ä»»åŠ¡ç®¡ç†
- âœ… RAGæ™ºèƒ½é—®ç­”
- âœ… æ•°æ®åˆ†æç»Ÿè®¡
- âœ… å¾®ä¿¡å…¬ä¼—å·å†…å®¹çˆ¬å–
- âœ… å®šæ—¶æ¸…ç†ä»»åŠ¡
- âœ… è½¯åˆ é™¤æœºåˆ¶
